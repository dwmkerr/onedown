var app=angular.module("app",["ngRoute","auth0","angular-storage","angular-jwt"]).config(["$routeProvider","$locationProvider",function(e){e.when("/create",{templateUrl:"app/pages/create/create.html",controller:"CreateController",requiresLogin:!0}).when("/crosswords",{templateUrl:"app/pages/crosswords/crosswords.html",controller:"CrosswordsController",resolve:{crosswords:["$http","ErrorService",function(e,o){return e.get("api/crosswords").then(function(e){return e.data},function(){o.error("Sorry","There was a problem loading the crosswords.")})}]}}).when("/crosswords/:crosswordId",{templateUrl:"app/pages/crossword/crossword.html",controller:"CrosswordController",resolve:{crossword:["$route","$http",function(e,o){return o.get("api/crosswords/"+e.current.params.crosswordId).then(function(e){return e.data},function(){ErrorService.error("Sorry","There was a problem loading the crossword.")})}]}}).otherwise({templateUrl:"app/pages/home/home.html",controller:"HomeController"})}]).config(["authProvider",function(e){e.init({domain:"dwmkerr.auth0.com",clientID:"oWeXhqDS5VLh8asTvNUEqKFA6wIbGIsJ",callbackURL:location.href,loginUrl:"/login"})}]).config(["authProvider","$httpProvider","jwtInterceptorProvider",function(e,o,r){r.tokenGetter=["store",function(e){return e.get("token")}],o.interceptors.push("jwtInterceptor")}]).run(["auth",function(e){e.hookEvents()}]).run(["$rootScope","auth","store","jwtHelper","$location",function(e,o,r,t,n){e.$on("$locationChangeStart",function(){if(!o.isAuthenticated){var e=r.get("token");e&&(t.isTokenExpired(e)?n.path("/"):o.authenticate(r.get("profile"),e))}})}]);angular.module("app").directive("odMenu",["$location","auth","store","IdentityService",function(e,o,r,t){return{restrict:"E",templateUrl:"app/menu/od-menu.html",link:function(e){e.auth=o,e.login=function(){t.ensureLoggedIn()},e.logout=function(){o.signout(),r.remove("profile"),r.remove("token")},e.isLoggedIn=function(){return o.isAuthenticated}}}}]),angular.module("app").factory("ErrorService",function(){function e(){this.errors=[]}return e.prototype.error=function(e,o){this.errors.push({title:e,message:o})},new e}),angular.module("app").factory("IdentityService",["$q","auth","store",function(e,o,r){function t(){}return t.prototype.ensureLoggedIn=function(){var t=e.defer();return o.isAuthenticated?t.resolve(o.profile):o.signin({},function(e,o){r.set("profile",e),r.set("token",o),t.resolve(e)}),t.promise},new t}]),angular.module("app").directive("odCrossword",function(){return{restrict:"E",templateUrl:"app/components/od-crossword/od-crossword.html",scope:{crossword:"=",selectedClue:"=",crosswordHeight:"="},link:function(e,o){var r=new CrosswordsJS.CrosswordDOM(e.crossword,o[0]);e.selectedClue&&r.selectClue(e.selectedClue);var t=e.$watch("selectedClue",function(o,t){o!==t&&void 0!==o&&r.selectClue(e.selectedClue)});r.onStateChanged=function(o){"clueSelected"===o.message&&e.selectedClue!==r.currentClue&&(e.selectedClue=r.currentClue,e.$apply())},e.$on("$destroy",function(){t(),r.destroy()}),e.crosswordHeight=$(r.crosswordElement).height()}}}),angular.module("app").directive("odNotifications",["ErrorService",function(e){return{restrict:"E",templateUrl:"app/components/od-notifications/od-notifications.html",scope:{},link:function(o){o.errors=e.errors}}}]),angular.module("app").controller("CreateController",["$scope",function(){}]),angular.module("app").controller("CrosswordController",["$scope","$q","$http","auth","IdentityService","crossword",function(e,o,r,t,n,s){if(e.title=s.title,e.setter=s.setter,s.solution){for(var l=s.acrossClues.concat(s.downClues),c={},u=0;u<l.length;u++)c[l[u].number+(u<s.acrossClues.length?"a":"d")]=l[u];for(u=0;u<s.solution.answers.length;u++)c[s.solution.answers[u].clueCode].answer=s.solution.answers[u].answer}var a=new CrosswordsJS.Crossword(s);e.crossword=a,e.acrossClues=a.acrossClues,e.downClues=a.downClues,e.isSelected=function(o){return o===e.selectedClue},e.selectClue=function(o){e.selectedClue=o},e.save=function(){n.ensureLoggedIn().then(function(){for(var e={answers:[]},o=a.acrossClues.concat(a.downClues),t=0;t<o.length;t++)o[t].answer&&e.answers.push({clueCode:o[t].code,answer:o[t].answer});r.post("api/crosswords/"+s._id+"/solution",e).then(function(){},function(){})})}}]),angular.module("app").controller("CrosswordsController",["$scope","crosswords",function(e,o){e.crosswords=o}]),angular.module("app").controller("HomeController",function(){});
//# sourceMappingURL=app.min.js.map